(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9a118f2"],{"0b00":function(e,t,a){"use strict";var i=a("74a3"),n=a.n(i);n.a},"55e4":function(e,t,a){"use strict";var i=a("9a03"),n=a.n(i);n.a},"74a3":function(e,t,a){},"9a03":function(e,t,a){},"9f93":function(e,t,a){"use strict";var i=a("e175"),n=a.n(i);n.a},c49c:function(e,t,a){"use strict";var i=a("e495"),n=a.n(i);n.a},d504:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{attrs:{column:"","fill-height":""}},[a("v-flex",[a("app-transcode-info")],1),a("v-flex",{attrs:{"mt-4":"","align-self-center":""}},[a("app-file-upload-button")],1)],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.hover;return a("v-btn",{staticClass:"mx-auto my-file-uploader",class:"elevation-"+(i?12:4),attrs:{ripple:"",flat:"",tag:"div"},on:{drop:function(t){return t.preventDefault(),t.stopPropagation(),e.onDrop(t)},dragover:function(t){return t.preventDefault(),t.stopPropagation(),e.onDragOver(t)},dragenter:function(t){return t.preventDefault(),t.stopPropagation(),e.onDragEnter(t)},dragleave:function(t){return t.preventDefault(),t.stopPropagation(),e.onDragLeave(t)},click:e.onClick}},[e._v("Пожалуйста положите файлы сюда")])}}])}),a("app-file-upload-dialog",{attrs:{dialog:e.dialog,rawFiles:e.files},on:{closeDialog:function(t){e.dialog=!1}}})],1)},s=[],o=(a("cadf"),a("551c"),a("097d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-scale-transition",[e.editDialog?a("app-edit-dialog",{attrs:{editfilename:e.editfilename,files:e.files},on:{cancel:e.cancelEditDialog,save:e.saveEditDialog}}):e._e()],1),a("div",{staticClass:"text-center"},[a("v-dialog",{staticClass:"title",attrs:{persistent:"","max-width":"900"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v("Импорт файлов")]),a("v-alert",{attrs:{value:e.successfulUpload,type:"success"}},[e._v("Ура! Закачалось!")]),a("v-alert",{attrs:{value:e.waitToUploadAlert,type:"warning"}},[e._v("Пожалуйста не закрывайте это окно до завершения операции")]),a("v-card-text",[a("span",{class:{"my-interaction-blocker":e.isUploading}}),a("v-progress-linear",{attrs:{slot:"progress",color:"blue",value:e.uploadPercent},slot:"progress"}),a("v-data-table",{staticClass:"elevation-2 my-data-table",attrs:{"hide-headers":e.isUploading,"hide-actions":"",headers:e.headers,items:e.files,"item-key":"index","disable-initial-sort":"","select-all":""},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",[a("v-checkbox",{attrs:{primary:"",disabled:e.isUploading,"hide-details":""},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"props.selected"}})],1),a("td",{staticClass:"my-name-cell",on:{click:e.showEditDialog}},[a("div",{staticClass:"my-name-field"},[e._v(e._s(t.item.fileName))])]),a("td",{staticClass:"text-right"},[e._v(e._s(e._f("humanReadableSize")(t.item.size)))])]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),a("v-card-actions",[a("v-select",{attrs:{"item-text":"name","item-value":"id",items:e.categories,error:!e.category,label:"Категория","hide-details":"",disabled:e.isUploading},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}}),a("v-spacer"),a("v-btn",{attrs:{color:"error",left:""},on:{click:e.closeUploadWindow}},[e._v("Отмена")]),a("v-btn",{attrs:{color:"warning",disabled:!e.selected.length,left:""},on:{click:e.remove}},[e._v("Удалить")]),a("v-btn",{attrs:{color:"success",disabled:!e.allowSubmit,left:""},on:{click:e.submitUploading}},[e._v("Импортировать")])],1)],1)],1)],1)],1)}),r=[],c=a("5d73"),d=a.n(c),u=(a("6762"),a("2fdb"),a("7f7f"),a("774e")),f=a.n(u),v=(a("7514"),a("ac6a"),a("cebc")),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"my-model-screen",on:{click:function(e){e.stopPropagation(),e.preventDefault()}}},[a("v-container",{staticClass:"my-edit-dialog",attrs:{"pa-3":""}},[a("v-layout",{attrs:{column:"",nowrap:""}},[a("v-flex",[a("v-text-field",{ref:"editor",attrs:{value:e.editfilename,rules:[e.max50chars,e.forbidenSymbols,e.notEmpty,e.notTheSameName],label:"Имя файла","single-line":"",clearable:"",counter:""},on:{keyup:[function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.save(t):null},function(t){return"button"in t||!e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?e.cancel(t):null}],input:function(t){e.fileName=t}}})],1),a("v-flex",[a("v-layout",{attrs:{row:"",nowrap:"","justify-end":""}},[a("v-flex",{attrs:{shrink:""}},[a("v-btn",{attrs:{color:"error",flat:"",right:""},on:{click:e.cancel}},[e._v("Отмена")])],1),a("v-flex",{attrs:{shrink:""}},[a("v-btn",{attrs:{flat:"",color:"success",disabled:!e.isValid},on:{click:e.save}},[e._v("Сохранить")])],1)],1)],1)],1)],1)],1)},h=[],m={props:["editfilename","files"],data:function(){var e=this;return{fileName:"",originalFileName:this.editfilename,max50chars:function(e){return!e||(e.length<=50||"Превышен размер!")},forbidenSymbols:function(e){if(e){var t=/[.*\\\/:'"|?]/i;return!t.test(e)||"Использован запрещенный символ"}return!0},notTheSameName:function(t){if(t){var a=0;return e.files.forEach(function(e){e.fileName===t&&a++}),a<2||"Такое имя уже есть!"}return!0},notEmpty:function(e){return e&&e.length>0||"Введите имя файла!"}}},computed:{isValid:function(){for(var e=[this.max50chars,this.forbidenSymbols,this.notTheSameName,this.notEmpty],t=0;t<e.length;t++){var a=e[t];if(!0!==a(this.fileName))return!1}return!0}},methods:{cancel:function(){this.$emit("cancel")},save:function(){if(this.isValid){var e={};e.originalFileName=this.originalFileName,e.changedFileName=this.fileName,this.$emit("save",e)}}},mounted:function(){this.$refs.editor.focus()}},g=m,b=(a("9f93"),a("2877")),x=a("6544"),_=a.n(x),y=a("8336"),w=a("a523"),D=a("0e8f"),C=a("a722"),k=a("2677"),E=Object(b["a"])(g,p,h,!1,null,"4d429ea2",null);E.options.__file="EditDialog.vue";var U=E.exports;_()(E,{VBtn:y["a"],VContainer:w["a"],VFlex:D["a"],VLayout:C["a"],VTextField:k["a"]});var V=a("2f62"),F={props:["rawFiles","dialog"],components:{appEditDialog:U},data:function(){return{editDialog:!1,editfilename:"",successfulUpload:!1,waitToUploadAlert:!1,category:"",isUploading:!1,selected:[],headers:[{text:"Имя файла",value:"name"},{text:"Размер",value:"size"}],files:[]}},computed:Object(v["a"])({},Object(V["c"])({uploadPercent:"files/uploadPercent",categories:"categories/categories",allowedExtension:"files/allowedExtension"}),{allowSubmit:function(){return!this.isUploading&&this.category&&this.files.length>0}}),watch:{category:function(e){this.files.forEach(function(t){t.category=e})},uploadPercent:function(e){var t=this;e>=100&&(this.waitToUploadAlert=!1,this.successfulUpload=!0,setTimeout(function(){t.$emit("closeDialog"),t.resetCustomData()},1500))},dialog:function(e){e?this.files=this.transformFiles(this.rawFiles):this.resetCustomData()}},methods:Object(v["a"])({},Object(V["b"])({uploadFiles:"files/uploadFiles",cancelUpload:"files/cancelUpload"}),Object(V["d"])({setUploadPercent:"files/setUploadPercent"}),{showEditDialog:function(e){this.editfilename=e.target.textContent,this.editDialog=!0},cancelEditDialog:function(){this.editfilename="",this.editDialog=!1},saveEditDialog:function(e){var t=this.files.find(function(t){return t.fileName===e.originalFileName});t&&(t.fileName=e.changedFileName),this.editfilename="",this.editDialog=!1},transformFiles:function(e){var t=this.allowedExtension;function a(e){var a=f()(e);return{splitExtension:function(){return a=a.map(function(e){var t=e.name,a=t.lastIndexOf(".");return-1!==a?[e,t.slice(0,a),t.slice(a).toLowerCase()]:[e,t,""]}),this},filterBasedOnExtension:function(){return a=a.filter(function(e){return t.includes(e[2])}),this},addInfo:function(){return 0===a.length?(a=[],this):(a=a.map(function(e,t){return{file:e[0],fileName:e[1],size:e[0].size,extension:e[2],index:t}}),this)},getFiles:function(){return a}}}return a(e).splitExtension().filterBasedOnExtension().addInfo().getFiles()},resetCustomData:function(){this.isUploading=!1,this.setUploadPercent(0),this.category="",this.selected=[],this.waitToUploadAlert=!1,this.successfulUpload=!1,this.files=[],window.removeEventListener("beforeunload",this.warnUserBeforeLeave)},submitUploading:function(){this.isUploading=!0,this.waitToUploadAlert=!0,this.uploadFiles(this.files),window.addEventListener("beforeunload",this.warnUserBeforeLeave)},closeUploadWindow:function(){if(this.isUploading){if(!confirm("Отменить загрузку файлов?"))return;this.cancelUpload(this.files)}this.resetCustomData(),this.$emit("closeDialog")},warnUserBeforeLeave:function(e){return e.preventDefault(),e.returnValue="","В данный момент идет закачка файлов. Хотите прервать процесс?"},remove:function(){var e=f()(this.files),t=null,a=!0,i=!1,n=void 0;try{for(var l,s=d()(this.selected);!(a=(l=s.next()).done);a=!0){var o=l.value;t=e.indexOf(o),e.splice(t,1)}}catch(r){i=!0,n=r}finally{try{a||null==s.return||s.return()}finally{if(i)throw n}}this.files=e,this.selected=[]}})},T=F,N=(a("c49c"),a("0798")),O=a("b0af"),S=a("99d9"),j=a("12b2"),I=a("ac7c"),L=a("8fea"),P=a("169a"),$=a("8e36"),B=a("0789"),R=a("b56d"),z=a("9910"),A=Object(b["a"])(T,o,r,!1,null,"ff6d6f8a",null);A.options.__file="FileUploadDialog.vue";var H=A.exports;_()(A,{VAlert:N["a"],VBtn:y["a"],VCard:O["a"],VCardActions:S["a"],VCardText:S["b"],VCardTitle:j["a"],VCheckbox:I["a"],VDataTable:L["a"],VDialog:P["a"],VProgressLinear:$["a"],VScaleTransition:B["d"],VSelect:R["a"],VSpacer:z["a"]});var J={components:{appFileUploadDialog:H},data:function(){return{dialog:!1,files:[]}},methods:{onDragEnter:function(){},onDragLeave:function(){},onDragOver:function(){},onClick:function(e){var t=this;function a(t){var a=document.createElement("input");a.type="file",a.setAttribute("multiple","multiple"),a.addEventListener("change",t,e),a.dispatchEvent(new MouseEvent("click"))}var i=function(e){var a=e.path?e.path[0].files:e.originalTarget.files;t.onDrop({dataTransfer:{files:a}})};a(i)},onDrop:function(e){var t=e.dataTransfer,a=t.files;this.files=a,this.dialog=!0}}},W=J,M=(a("55e4"),a("ce87")),q=Object(b["a"])(W,l,s,!1,null,"3114a6a4",null);q.options.__file="FileUploadButton.vue";var G=q.exports;_()(q,{VBtn:y["a"],VHover:M["a"]});var K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-layout",{staticClass:"container",attrs:{row:""}},[a("v-flex",{attrs:{"align-self-start":""}},[a("v-card",[a("v-card-title",{staticClass:"title my-title"},[e._v("Импортируемые файлы:\n        "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"search",label:"Поиск","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),a("v-data-table",{staticClass:"my-data-table",attrs:{"hide-actions":"",headers:e.headers,items:e.files,search:e.search,"custom-filter":e.customFilter,transition:"scale-transition"},scopedSlots:e._u([{key:"items",fn:function(t){return[a("td",{staticClass:"text-left"},[e._v(e._s(t.item.id))]),a("td",{staticClass:"text-left"},[a("div",{staticClass:"my-name-field"},[e._v(e._s(t.item.fileName))])]),a("td",{staticClass:"text-left"},[a("v-progress-circular",{attrs:{rotate:270,size:43,width:5,value:t.item.progress,color:"green accent-4"}},[e._v(e._s(t.item.progress||0))])],1),a("td",{staticClass:"text-left"},[e._v(e._s(e._f("statusToText")(t.item.status,e.statusText)))]),a("td",{staticClass:"text-left"},[e._v(e._s(e.categoryToString(t.item.category)))]),a("td",{staticClass:"text-left"},[e._v(e._s(e._f("workerIDToHR")(t.item.workerID)))]),a("td",{staticClass:"text-left"},[e._v(e._s(e._f("durationToHR")(t.item.duration)))]),a("td",{staticClass:"text-left"},[e._v(e._s(e._f("humanReadableSize")(t.item.size)))]),a("td",[a("v-icon",{on:{click:function(a){e.deleteItem(t.item)}}},[e._v("delete")])],1)]}}])})],1)],1)],1)},Q=[],X=(a("c5f6"),a("6b54"),{data:function(){return{search:"",selected:[],statusText:["Завершено","Ошибка","Кодируется","Ожидание"],headers:[{text:"ID",value:"id",align:"left",width:50},{text:"Имя файла",value:"fileName",align:"left",width:350},{text:"Прогресс",value:"progress",align:"left",width:100},{text:"Статус",value:"status",align:"left",width:100},{text:"Категория",value:"category",align:"left",width:100},{text:"№ Обработчика",value:"workerID",align:"left",width:50},{text:"Длительность",value:"duration",align:"left",width:50},{text:"Размер",value:"size",align:"left",width:120},{text:"Удалить",value:"id",sortable:!1,width:150}]}},filters:{statusToText:function(e,t){return t[e]}},computed:Object(v["a"])({},Object(V["c"])({files:"files/files",categories:"categories/categories"})),methods:Object(v["a"])({},Object(V["b"])({deleteFile:"files/deleteFile"}),{customFilter:function(e,t,a){return t=t.toString().toLowerCase(),e.filter(function(e){return a(e["fileName"],t)})},deleteItem:function(e){confirm("Вы уверены что хотите удалить файл ".concat(e.fileName,"?"))&&this.deleteFile(e.id)},categoryToString:function(e){return this.categories.find(function(t){return t.id===Number(e)}).name}})}),Y=X,Z=(a("0b00"),a("132d")),ee=a("490a"),te=Object(b["a"])(Y,K,Q,!1,null,"2eb542e2",null);te.options.__file="TranscodeInfo.vue";var ae=te.exports;_()(te,{VCard:O["a"],VCardTitle:j["a"],VDataTable:L["a"],VFlex:D["a"],VIcon:Z["a"],VLayout:C["a"],VProgressCircular:ee["a"],VSpacer:z["a"],VTextField:k["a"]});var ie={components:{appFileUploadButton:G,appTranscodeInfo:ae},data:function(){return{}},created:function(){this.$socket.emit("join","FILEINFO",function(e){e&&console.log("ERROR joining ",e)})},beforeDestroy:function(){this.$socket.emit("leave","FILEINFO",function(e){e&&console.log("ERROR leaving ",e)})}},ne=ie,le=Object(b["a"])(ne,i,n,!1,null,null,null);le.options.__file="Index.vue";t["default"]=le.exports;_()(le,{VFlex:D["a"],VLayout:C["a"]})},e175:function(e,t,a){},e495:function(e,t,a){}}]);